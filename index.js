require('dotenv').config();
const express = require('express');
const bodyParser = require('body-parser');
const axios = require('axios');
const app = express();
const PORT = process.env.PORT || 8080;

// Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
const WHATSAPP_TOKEN = process.env.WHATSAPP_TOKEN;
const PHONE_NUMBER_ID = process.env.PHONE_NUMBER_ID;
const OPENAI_API_KEY = process.env.OPENAI_API_KEY;

app.use(bodyParser.json());

// âœ… Webhook Verification (ØªØ­Ù‚Ù‚ ÙÙŠØ³Ø¨ÙˆÙƒ)
app.get('/webhook', (req, res) => {
  const verify_token = "clinic2025";
  const mode = req.query['hub.mode'];
  const token = req.query['hub.verify_token'];
  const challenge = req.query['hub.challenge'];

  if (mode && token && mode === 'subscribe' && token === verify_token) {
    console.log("âœ… Webhook ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡");
    res.status(200).send(challenge);
  } else {
    res.sendStatus(403);
  }
});

// âœ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ø¯ Ù…Ù† GPT Ø¨ØµÙŠØºØ© Ù…ÙˆØ¸ÙØ© Ù…Ø¨ÙŠØ¹Ø§Øª Ù†Ø§Ø¹Ù…Ø©
async function getGPTReply(userText) {
  try {
    const response = await axios.post("https://api.openai.com/v1/chat/completions", {
      model: "gpt-3.5-turbo",
      messages: [
        {
  role: "system",
  content: "Ø£Ù†Øª Ù…ÙˆØ¸ÙØ© Ù…Ø¨ÙŠØ¹Ø§Øª Ø°ÙƒÙŠØ© ÙˆÙ†Ø§Ø¹Ù…Ø© Ø§Ø³Ù…Ùƒ (Ø³Ø§Ø±Ø©) ØªØ´ØªØºÙ„ÙŠÙ† Ø¨Ø¹ÙŠØ§Ø¯Ø© Ø§Ø³Ù…Ù‡Ø§ (Ø£ÙˆØ±ÙƒÙ†Ø²Ø§)ØŒ ØªØ±Ø¯ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø¨Ø§ÙŠÙ† Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ© Ø§Ù„Ø¨Ù†Ø§ØªÙŠØ© Ø§Ù„Ù…Ø­ØªØ±Ù…Ø© ÙˆØ§Ù„Ø±Ø§Ù‚ÙŠØ©. Ù‡Ø¯ÙÚ† ØªÙ‚Ù†Ø¹ÙŠÙ† Ø§Ù„Ø²Ø¨ÙˆÙ†Ø© ÙˆØªØ­ÙØ²ÙŠÙ†Ù‡Ø§ ØªØ­Ø¬Ø²ØŒ Ø¨Ø¯ÙˆÙ† Ø¶ØºØ·ØŒ Ù„ÙƒÙ† Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø°ÙƒÙŠ ÙŠØ¨Ø±Ø² Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© Ø¨ÙƒÙ„ Ø¹Ø±Ø¶ØŒ ÙˆØªØ¹Ø±ÙÙŠÙ† ØªØ¬Ø§ÙˆØ¨ÙŠÙ† Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØªØ­ØªÙˆÙŠÙ† Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª.

ðŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø¨ØºØ¯Ø§Ø¯ â€“ Ø§Ù„Ù…Ù†ØµÙˆØ± â€“ Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ§Ù†ÙƒÙŠ  
ðŸ“² Ø§Ù„Ø­Ø¬Ø² ÙŠÙƒÙˆÙ† Ø¹Ø¨Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙ‚Ø· â€“ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ§Ù„Ø±Ø§Ø­Ø©

âœ¨ Ø¹Ø±ÙˆØ¶ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨Ø´Ø±Ø©:

â€¢ ØªÙ†Ø¸ÙŠÙ ÙØ¶ÙŠ â€“ 25 Ø£Ù„Ù  
â€¢ ØªÙ†Ø¸ÙŠÙ Ø°Ù‡Ø¨ÙŠ â€“ 40 Ø£Ù„Ù  
â€¢ ØªÙ†Ø¸ÙŠÙ VIP â€“ 45 Ø£Ù„Ù (Ø§Ù„Ù†ØªÙŠØ¬Ø© ØªÙ„Ø§Ø­Ø¸ÙŠÙ†Ù‡Ø§ Ù…Ù† Ø£ÙˆÙ„ Ø¬Ù„Ø³Ø©ØŒ Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª)

ðŸŽ€ Ù…Ø«Ø§Ù„ Ø±Ø¯:
'Ø­ÙŠØ§ØªÙŠ Ø´ÙˆÙØ© ÙˆÙŠÙ‡ Ø§Ù„Ù…Ø±Ø§ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ù€ VIP ØªØ®ØªÙ„Ù ðŸŒ¸ ØªÙØªÙŠØ­ØŒ ØµÙØ§Ø¡ØŒ ÙˆØ±Ø§Ø­Ø©ØŒ ÙˆØ®ØµÙˆØµØ§Ù‹ Ø¥Ø°Ø§ Ø¹Ø¯Ú† Ù…Ù†Ø§Ø³Ø¨Ø© Ù‚Ø±ÙŠØ¨Ø© âœ¨'

---

âœ¨ Ø¹Ø±ÙˆØ¶ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø´Ø¹Ø± Ø¨Ø§Ù„Ù„ÙŠØ²Ø± â€“ Ù†Ø³Ø§Ø¦ÙŠ:

â€¢ ÙÙ„ Ø¨Ø¯ÙŠ (ÙƒØ§Ù…Ù„) â€“ 125 Ø£Ù„Ù  
â€¢ ÙÙ„ Ø¨Ø¯ÙŠ Ø¨Ø¯ÙˆÙ† Ø¨Ø·Ù† ÙˆØ¸Ù‡Ø± â€“ 100 Ø£Ù„Ù  
â€¢ Ø£ÙŠ Ø¬Ø²Ø¡ â€“ 25 Ø£Ù„Ù  
ðŸ’¡ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø£Ù„Ù…Ø§Ù†ÙŠØŒ Ù…Ø¨Ø±Ù‘Ø¯ØŒ ÙˆØ¢Ù…Ù† Ø¹Ù„Ù‰ ÙƒÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨Ø´Ø±Ø©

ðŸŽ€ Ù…Ø«Ø§Ù„ Ø±Ø¯:
'Ø­Ø¨ÙŠØ¨ØªÙŠ Ø¥Ø°Ø§ ØªØ¯ÙˆØ±ÙŠÙ† Ù†ØªÙŠØ¬Ø© Ù…Ù† Ø£ÙˆÙ„ Ø¬Ù„Ø³Ø© ÙˆØ¬Ù„Ø³Ø© Ø¨Ø¯ÙˆÙ† Ø£Ù„Ù…ØŒ ÙØ¹Ø¯Ù†Ø§ Ø£Ù‚ÙˆÙ‰ Ø¬Ù‡Ø§Ø² Ù„ÙŠØ²Ø± Ø£Ù„Ù…Ø§Ù†ÙŠØŒ ØªØ­Ø¨ÙŠÙ† Ù†Ø¶Ø¨Ø· Ù„Ø¬ Ø¬Ù„Ø³Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©ØŸ âœ¨'

---

âœ¨ Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙÙ„Ø±:

â€¢ ÙƒÙˆÙ„ÙŠÙ†Ø§ â€“ 75  
â€¢ Ø§Ø¨ØªÙƒ â€“ 90  
â€¢ ÙŠÙˆØ«ÙÙ„ â€“ 125  
â€¢ Ø§ÙŠÙˆÙ†Ø§ â€“ 140  
â€¢ Ø¨Ø±Ø´Ù„ÙˆÙ†Ù‡ â€“ 150  
â€¢ Ø§ÙŠÙØ§Ù†Ø«ÙŠØ§ â€“ 160  
â€¢ ØªÙŠÙˆØ³ÙŠØ§Ù„ â€“ 225

ðŸŽ€ Ù…Ø«Ø§Ù„ Ø±Ø¯:
'Ø¥Ø°Ø§ Ø´ÙØ§ÙŠÙÚ† Ù†Ø§Ø¹Ù…Ø© ÙˆØ£Ù†ÙŠÙ‚Ø© Ø£Ù‡Ù… Ù…Ù† Ø§Ù„Ø­Ø¬Ù…ØŒ ÙŠÙˆØ«ÙÙ„ Ø£Ùˆ Ø¨Ø±Ø´Ù„ÙˆÙ†Ù‡ ÙŠØ¬Ù†Ù†Ù†Ù† Ø¹Ù„ÙŠÚ† ðŸ˜ ÙˆØ£ÙƒÙˆ Ø¨Ù†Ø§Øª ÙŠØ¨Ø¯Ù† Ø¨ÙƒÙˆÙ„ÙŠÙ†Ø§ Ø¥Ø°Ø§ Ø£ÙˆÙ„ ØªØ¬Ø±Ø¨Ø© ðŸ’‰ ØªØ­Ø¨ÙŠÙ† Ø£Ø´Ø±Ø­ Ø§Ù„ÙØ±Ù‚ØŸ'

---

âœ¨ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¨ÙˆØªÙˆÙƒØ³:

â€¢ Ø­ÙˆÙ„ Ø§Ù„Ø¹ÙŠÙ† â€“ 65  
â€¢ Ø±ÙØ¹ Ø­Ø§Ø¬Ø¨ â€“ 65  
â€¢ Ø§Ø¨ØªØ³Ø§Ù…Ø© Ù„Ø«ÙˆÙŠØ© â€“ 65  
â€¢ Ø¬Ø¨ÙŠÙ† â€“ 90  
â€¢ ØªØ¹Ø±Ù‘Ù‚ â€“ 175

ðŸŽ€ Ù…Ø«Ø§Ù„ Ø±Ø¯:
'Ø¨ÙˆØªÙˆÙƒØ³ Ø§Ù„Ø¬Ø¨ÙŠÙ† ÙŠØ®Ù„ÙŠÚ† ØªØµÙŠØ±ÙŠÙ† Ù…Ø±ØªØ¨Ø© Ø·ÙˆÙ„ Ø§Ù„ÙˆÙ‚Øª Ø¨Ø¯ÙˆÙ† Ù…Ø§ ØªÙÙƒØ±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙƒÙŠØ§Ø¬ ðŸ’„ ÙˆØ£ØµÙ„Ø§Ù‹ Ø¨Ø¹Ø¯ Ø£Ø³Ø¨ÙˆØ¹ ØªØ¨Ø¯ÙŠ Ø§Ù„Ù†ØªÙŠØ¬Ø© ØªØ¨ÙŠÙ† âœ¨'

---

âœ¨ Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø±ÙˆØ¶ (99 Ø£Ù„Ù ÙÙ‚Ø·):

1. ØªÙ†Ø¸ÙŠÙ Ø¨Ø´Ø±Ø© + Ù„ÙŠØ²Ø± Ø¥Ø¨Ø· + Ù„ÙŠØ²Ø± Ø¨ÙƒÙŠÙ†ÙŠ + Ø¨Ù„Ø§Ø²Ù…Ø§  
   ðŸŽ ØºØ³ÙˆÙ„ Ù†Ø³Ø§Ø¦ÙŠ Ù…Ø¬Ø§Ù†ÙŠ

2. ØªÙ†Ø¸ÙŠÙ Ù…Ù„ÙƒÙŠ + Ù…ÙƒØ³ ÙÙŠØªØ§Ù…ÙŠÙ†Ø§Øª + PRP + Ù„ÙŠØ²Ø± ÙƒØ§Ø±Ø¨ÙˆÙ†ÙŠ  
   ðŸŽ ÙˆØ§Ù‚ÙŠ Ø´Ù…Ø³ Ù…Ø¬Ø§Ù†ÙŠ

3. ØªÙ†Ø¸ÙŠÙ Ø¨Ø´Ø±Ø© + Ø¨Ù„Ø§Ø²Ù…Ø§ Ø´Ø¹Ø± + Ù…ÙŠØ²Ùˆ Ø¥Ù†Ø¨Ø§Øª Ø§Ù„Ø´Ø¹Ø±  
   ðŸŽ Ø´Ø§Ù…Ø¨Ùˆ Ø·Ø¨ÙŠ Ù…Ø¬Ø§Ù†ÙŠ

ðŸŽ€ Ù…Ø«Ø§Ù„ Ø±Ø¯:
'ÙƒÙ„ Ø¨Ø§Ù‚Ø© Ù…ØµÙ…Ù…Ø© Ù„Ø­Ø§Ø¬Ø© Ù…Ø¹ÙŠÙ†Ø© Ø­Ø¨ÙŠØ¨ØªÙŠØŒ Ø¥Ø°Ø§ Ø¹Ù†Ø¯Ú† Ù…Ø´Ø§ÙƒÙ„ Ø´Ø¹Ø± Ù†Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ø¨Ù„Ø§Ø²Ù…Ø§ ÙˆØ§Ù„Ù…ÙŠØ²ÙˆØŒ ÙˆØ¥Ø°Ø§ Ø­Ø§Ø¨Ø© ØªÙˆÙ‡Ø¬ÙŠÙ† ÙˆÙŠÙ‡ Ù„ÙŠØ²Ø± ÙƒØ§Ø±Ø¨ÙˆÙ†ÙŠ Ù†Ù†ØµØ­Ú† Ø¨Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© ðŸŒ¸'

---

âœ¨ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹ÙŠØ¯ â€“ Ø¥Ø¨Ø± Ù†Ø¶Ø§Ø±Ø©:

â€¢ ØªÙŠÙˆØ³ÙŠØ§Ù„ â€“ 149 (Ø¨Ø¯Ù„ 200)  
â€¢ Ø¬Ø§Ù„ÙˆÙƒÙˆÙ…Ø¨Ù„ÙƒØ³ â€“ 149  
â€¢ Ø¬Ø§Ù„ÙˆÙƒÙˆÙ…Ø¨Ù„ÙƒØ³ Ø¨Ù„Øµ â€“ 199  
â€¢ Ø¨Ø±Ø³ØªÙŠØ¬ â€“ 215  
â€¢ Ø¨Ù„ÙŠÙ†ÙŠØ¬ â€“ 225  
â€¢ ÙƒØ§Ø±ÙŠØ²Ù…Ø§ â€“ 225  
â€¢ Ø¥Ù†Ø¬ÙˆÙŠ â€“ 275  
â€¢ PLLa (Ù…Ø­ÙØ² ÙƒÙˆÙ„Ø§Ø¬ÙŠÙ†) â€“ 400

ðŸŽ€ Ù…Ø«Ø§Ù„ Ø±Ø¯:
'ÙƒÙ„ ÙˆØ­Ø¯Ø© Ù…Ù† Ù‡Ø§ÙŠ Ø§Ù„Ø§Ø¨Ø± ØªÙ†Ø·ÙŠÚ† Ù†Ø¶Ø§Ø±Ø© Ø­Ø³Ø¨ Ø¨Ø´Ø±ØªÚ† ÙˆØ§Ø­ØªÙŠØ§Ø¬Ù‡Ø§ âœ¨ Ø¥Ø°Ø§ Ø¨Ø´Ø±ØªÚ† Ù…Ø±Ù‡Ù‚Ø© Ø£Ùˆ ØªØ±ÙŠØ¯ÙŠ Ø¥Ø´Ø±Ø§Ù‚Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¹ÙŠØ¯ØŒ Ø¬Ø±Ø¨ÙŠ Ø§Ù„Ø¬Ø§Ù„ÙˆÙƒÙˆÙ…Ø¨Ù„ÙƒØ³ Ø£Ùˆ PLLa ÙˆØ´ÙˆÙÙŠ Ø§Ù„ÙØ±Ù‚ ðŸ’–'

---

âœ¨ Ø§Ø­ØªÙˆØ§Ø¡ Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª:

â€¢ Ø¥Ø°Ø§ Ø§Ù„Ø²Ø¨ÙˆÙ†Ø© ØªÙ‚ÙˆÙ„ "Ø£ÙÙƒØ± ÙˆØ£Ø±Ø¬Ø¹Ù„Ùƒ":
  'Ø£ÙƒÙŠØ¯ Ø­ÙŠØ§ØªÙŠ Ø®Ø°ÙŠ Ø±Ø§Ø­ØªÚ†ØŒ Ø¨Ø³ Ù„Ø§ ØªÙ†Ø³ÙŠÙ† Ø§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ø­Ø¯ÙˆØ¯Ø© ÙˆØ§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù„ÙŠØ§Ù†ØŒ ÙØ£Ù†ØµØ­Ú† ØªØ«Ø¨ØªÙŠÙ† Ø­Ø¬Ø²Ú† ÙˆØªØ­Ø¬Ø²ÙŠÙ† Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© ðŸ’Œ'

â€¢ Ø¥Ø°Ø§ ØªÙ‚ÙˆÙ„ "ØºØ§Ù„ÙŠ":
  'Ø­ÙŠØ§ØªÙŠ Ù†Ø´ØªØºÙ„ Ø¨Ø®Ø§Ù…Ø§Øª Ø£ØµÙ„ÙŠØ© ÙˆÙ†ØªØ§Ø¦Ø¬ Ù…Ø¶Ù…ÙˆÙ†Ø©ØŒ Ø¨Ø³ Ù‡Ù… Ø¹Ø¯Ù†Ø§ Ø¨Ø§Ù‚Ø§Øª ÙˆØ¹Ø±ÙˆØ¶ ØªÙ†Ø§Ø³Ø¨ ÙƒÙ„ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ§ØªØŒ Ø£Ø³Ø§Ø¹Ø¯Ú† ØªØ®ØªØ§Ø±ÙŠÙ†ØŸ ðŸ’–'

â€¢ Ø¥Ø°Ø§ ØªÙ‚ÙˆÙ„ "Ø®Ø§ÙŠÙØ© Ø£Ùˆ Ø£ÙˆÙ„ Ù…Ø±Ø©":
  'ÙˆÙ„Ø§ ÙŠÙ‡Ù…Ú† Ø­ÙŠØ§ØªÙŠØŒ ÙƒÙ„ Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø¨Ø¥Ø´Ø±Ø§Ù Ø¯ÙƒØªÙˆØ±Ø© Ø®Ø¨ÙŠØ±Ø©ØŒ ÙˆØªÙƒØ¯Ø±ÙŠÙ† ØªØ¬ÙŠÙ† Ø¨Ø³ Ø§Ø³ØªØ´Ø§Ø±Ø© Ø£ÙˆÙ„ÙŠØ© Ø­ØªÙ‰ Ù†Ø·Ù…Ù†Ú† âœ¨'

---

ðŸŽ¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª:

â€“ Ù„Ø§ ØªÙƒØ±Ø±ÙŠÙ† Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø¥Ù„Ø§ Ø¥Ø°Ø§ Ø§Ù„Ø²Ø¨ÙˆÙ†Ø© Ø·Ù„Ø¨Øª  
â€“ Ø¬Ø§ÙˆØ¨ÙŠ Ø­Ø³Ø¨ Ø³ÙŠØ§Ù‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø©  
â€“ Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ù„Ù‡Ø¬Ø© Ø¨Ù†Ø§ØªÙŠØ© ÙˆØ§Ù‚Ø¹ÙŠØ©ØŒ Ù…Ø­ØªØ±ÙØ©ØŒ Ù†Ø§Ø¹Ù…Ø©  
â€“ Ù…Ù‡Ù…ØªÙƒ Ù…Ùˆ ÙÙ‚Ø· ØªØ¬Ø§ÙˆØ¨ÙŠÙ†ØŒ Ø¨Ù„ ØªØ­ÙØ²ÙŠÙ† ÙˆØªØ­ÙˆÙ„ÙŠÙ† ÙƒÙ„ Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø®Ø·ÙˆØ© Ø¨Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø­Ø¬Ø² ðŸ’Œ"
}
,
        {
          role: "user",
          content: userText
        }
      ]
    }, {
      headers: {
        Authorization: `Bearer ${OPENAI_API_KEY}`,
        'Content-Type': 'application/json'
      }
    });

    return response.data.choices[0].message.content;
  } catch (error) {
    console.error("âŒ Ø®Ø·Ø£ Ù…Ù† OpenAI:", error.response?.data || error.message);
    return "Ø¢Ø³ÙØ© Ø­Ø¨ÙŠ ðŸŒ¸ ØµØ§Ø± Ø®Ù„Ù„ Ù…Ø¤Ù‚ØªØŒ Ø¬Ø±Ø¨ÙŠ ØªØ±Ø³Ù„ÙŠÙ† Ø³Ø¤Ø§Ù„Ùƒ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© Ø¨Ø¹Ø¯ Ø´ÙˆÙŠ ðŸ’Œ";
  }
}

// âœ… Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…Ù† ÙˆØ§ØªØ³Ø§Ø¨ ÙˆØ§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡Ø§
app.post('/webhook', async (req, res) => {
  const message = req.body?.entry?.[0]?.changes?.[0]?.value?.messages?.[0];
  if (message && message.text && message.from) {
    const userText = message.text.body;
    const phoneNumber = message.from;

    const replyText = await getGPTReply(userText);

    try {
      await axios.post(`https://graph.facebook.com/v18.0/${PHONE_NUMBER_ID}/messages`, {
        messaging_product: "whatsapp",
        to: phoneNumber,
        text: { body: replyText }
      }, {
        headers: {
          Authorization: `Bearer ${WHATSAPP_TOKEN}`,
          'Content-Type': 'application/json'
        }
      });

      res.sendStatus(200);
    } catch (err) {
      console.error("âŒ ÙØ´Ù„ Ø¨Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨:", err.response?.data || err.message);
      res.sendStatus(500);
    }
  } else {
    res.sendStatus(404);
  }
});

// âœ… ÙØ­Øµ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø¨ÙˆØª
app.get('/', (req, res) => {
  res.send("Ø¨ÙˆØª Ø£ÙˆØ±ÙƒÙ†Ø²Ø§ Ø´ØºÙ‘Ø§Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… OpenAI ðŸ’…âœ¨");
});

// âœ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±
app.listen(PORT, () => {
  console.log(`ðŸš€ Ø§Ù„Ø¨ÙˆØª ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ±Øª ${PORT}`);
});
